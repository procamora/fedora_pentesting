#!/bin/bash


#trap 'exit 130' INT #Exit if trap Ctrl+C
trap ctrl_c INT


RED='\033[0;31m'
GREEN='\033[0;32m'
NC='\033[0m' # No Color


function ctrl_c(){
    echo -e "\n${RED}Exiting...${NC}"
    exit 0
}


function print() {
    echo -e "${GREEN}$1${NC}"
    >&2 echo -e "${RED}$1${NC}"
}


sudo dnf -y install kernel-headers kernel-devel git make libxml2 libxml2-devel \
 cmake python3-devel gcc-c++ dkms openssl-devel p7zip-plugins zip unzip unrar \
 git wget curl perl-devel ruby-devel gem python3-devel python3-pip make gcc cmake \
 g++ dos2unix java-openjdk java-1.8.0-openjdk-javadoc java-1.8.0-openjdk-devel \
 lua-devel vim-common bzip2 gzip 

sudo dnf groupinstall -y "Development Tools"

sudo pip install pynput pyftpdlib configparser termcolor capstone

# COPIAR DIRECTORRIO /use/share/john/ssh2john.py




#login con usuario
#su usuario

#ejecutar script con sudo para n usuario
#sudo -u usuario /bin/bash 


#investigar sobre LFI (acceso a ficheros por url)
#https://book.hacktricks.xyz/pentesting-web/file-inclusion
#https://pequalsnp-team.github.io/cheatsheet/steganography-101

# install foxyproxy


#poner las cosas de /us/share  como webshells, dictio etc

sudo mkdir -p /usr/share/{wordlists,exploitation,}/




print "install seclists"
DIR="/usr/share/seclists/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/danielmiessler/SecLists $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R



print "install rockyou"
sudo wget https://gitlab.com/kalilinux/packages/wordlists/-/raw/kali/master/rockyou.txt.gz \
 -O /usr/share/wordlists/rockyou.txt.gz
sudo gzip -f -d /usr/share/wordlists/rockyou.txt.gz


# Information Gathering 

sudo dnf install -y amap dnsenum dnsmap nikto nmap finger


print "install snmpcheck"
sudo wget https://gitlab.com/kalilinux/packages/snmpcheck/-/raw/kali/master/snmpcheck-1.9.rb \
 -O /usr/local/bin/snmpcheck
gem install snmp
sudo chmod +x /usr/local/bin/snmpcheck

print "install smtp-user-enum"
sudo wget https://raw.githubusercontent.com/pentestmonkey/smtp-user-enum/master/smtp-user-enum.pl \
 -O /usr/local/bin/smtp-user-enum
sudo chmod +x /usr/local/bin/smtp-user-enum


print "install finger-user-enum"
sudo wget https://raw.githubusercontent.com/pentestmonkey/finger-user-enum/master/finger-user-enum.pl \
 -O /usr/local/bin/finger-user-enum
sudo chmod +x /usr/local/bin/finger-user-enum


print "install ftp-user-enum"
sudo wget https://raw.githubusercontent.com/pentestmonkey/ftp-user-enum/master/ftp-user-enum.pl \
 -O /usr/local/bin/ftp-user-enum
sudo chmod +x /usr/local/bin/ftp-user-enum


print "install ident-user-enum"
sudo wget https://raw.githubusercontent.com/pentestmonkey/ident-user-enum/master/ident-user-enum.pl \
 -O /usr/local/bin/ident-user-enum
sudo chmod +x /usr/local/bin/ident-user-enum


print "install enum4linux"
sudo wget https://gitlab.com/kalilinux/packages/enum4linux/-/raw/kali/master/enum4linux.pl \
 -O /usr/local/bin/enum4linux
sudo chmod +x /usr/local/bin/enum4linux


print "install masscan"
DIR="/opt/masscan/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/robertdavidgraham/masscan $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
cd $DIR
make -j4
! test -f /usr/local/bin/masscan && sudo ln -s $DIR/bin/masscan /usr/local/bin/masscan
cd -





# Vulnerability Analysis

sudo dnf install -y openvas-scanner openvas-manager sqlninja sslscan

print "install powerfuzzer"
# CONVERTIR A PYTHON3 Y AÃ‘ADIR LIBRERIAS
DIR="/opt/powerfuzzer/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/marcinguy/powerfuzzer $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
chmod +x $DIR/powerfuzzer.py
! test -f /usr/local/bin/powerfuzzer && sudo ln -s $DIR/powerfuzzer.py /usr/local/bin/powerfuzzer


# NO COMPILA
#DIR="/opt/sfuzz/"
#test -d $DIR && git -C $DIR pull
#! test -d $DIR && sudo git clone https://gitlab.com/kalilinux/packages/sfuzz $DIR \
# && sudo chown $(whoami):$(whoami) $DIR -R
#cd $DIR
#./configure
#make -j4
#cd -
#! test -f /usr/local/bin/sfuzz && sudo ln -s $DIR/sfuzz /usr/local/bin/sfuzz


print "install sqlmap"
DIR="/opt/sqlmap/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone --depth 1 https://github.com/sqlmapproject/sqlmap $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
chmod +x $DIR/sqlmap.py
! test -f /usr/local/bin/sqlmap && sudo ln -s $DIR/sqlmap.py /usr/local/bin/sqlmap










# Wireless Attacks

sudo dnf install -y aircrack-ng reaver










# Web Applications

# cutycapt


sudo dnf install -y wfuzz skipfish gobuster perl-CGI perl-HTTP-DAV
sudo gem install -n /usr/local/bin wpscan
sudo pip install dirbpy


print "install whatweb"
DIR="/opt/whatweb/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/urbanadventurer/WhatWeb $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
cd $DIR && sudo make -j && cd -
! test -f /usr/local/bin/whatweb && sudo ln -s $DIR/whatweb /usr/local/bin/whatweb


print "install websploit"
DIR="/opt/websploit/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/websploit/websploit $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
cd $DIR && sudo python setup.py install && cd -


print "install recon-ng"
DIR="/opt/recon-ng/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/lanmaster53/recon-ng $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
! test -f /usr/local/bin/recon-cli && sudo ln -s $DIR/recon-cli /usr/local/bin/recon-cli
! test -f /usr/local/bin/recon-ng && sudo ln -s $DIR/recon-ng /usr/local/bin/recon-ng
! test -f /usr/local/bin/recon-web && sudo ln -s $DIR/recon-web /usr/local/bin/recon-web


print "install joomscan"
DIR="/opt/joomscan/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/rezasp/joomscan $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
! test -f /usr/local/bin/joomscan && sudo ln -s $DIR/joomscan.pl /usr/local/bin/joomscan
chmod +x $DIR/joomscan.pl
dos2unix $DIR/joomscan.pl


print "install hURL"
sudo wget https://raw.githubusercontent.com/fnord0/hURL/master/hURL \
 -O /usr/local/bin/hURL
sudo chmod +x /usr/local/bin/hURL


print "install davtest"
DIR="/opt/davtest/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/cldrn/davtest $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
! test -f /usr/local/bin/davtest && sudo ln -s $DIR/davtest.pl /usr/local/bin/davtest
sudo chmod +x /usr/local/bin/davtest


print "install dirsearch"
DIR="/opt/dirsearch/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/maurosoria/dirsearch $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
! test -f /usr/local/bin/dirsearch && sudo ln -s $DIR/dirsearch.py /usr/local/bin/dirsearch
sudo chmod +x /usr/local/bin/dirsearch


# REQUIERE PYTHON2 + LIB  httplib2
#IR="/opt/fimap/"
#test -d $DIR && git -C $DIR pull
#! test -d $DIR && sudo git clone https://gitlab.tha-imax.de/root/fimap $DIR \
# && sudo chown $(whoami):$(whoami) $DIR -R 
#! test -f /usr/local/bin/fimap && sudo ln -s $DIR/src/fimap.py /usr/local/bin/fimap && \
# sed -i.back 's/!\/usr\/bin\/python/!\/usr\/bin\/python2/' $DIR/src/fimap.py
#sudo chmod +x /usr/local/bin/fimap


# REQUIERE PYTHON2 
#DIR="/opt/w3af/"
#test -d $DIR && git -C $DIR pull
#! test -d $DIR && sudo git clone https://github.com/andresriancho/w3af $DIR \
# && sudo chown $(whoami):$(whoami) $DIR -R
#! test -f /usr/local/bin/w3af && sudo ln -s $DIR/w3af.py /usr/local/bin/w3af
#sudo chmod +x /usr/local/bin/w3af


print "install ZAP"
FILE="ZAP_2_9_0_unix.sh"
wget https://github.com/zaproxy/zaproxy/releases/download/v2.9.0/ZAP_2_9_0_unix.sh \
 -O $FILE
chmod +x $FILE
sudo ./$FILE
/bin/rm $FILE


print "install burp"
FILE="burp.sh"
wget "https://portswigger.net/burp/releases/download?product=community&version=2020.7&type=Linux" \
 -O $FILE
chmod +x $FILE
sudo ./$FILE
/bin/rm $FILE












# Exploitation Tools

sudo dnf install -y libxml2


print "install exploit-database"
DIR="/opt/exploit-database/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/offensive-security/exploit-database $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
! test -f /usr/local/bin/w3af && sudo ln -s $DIR/searchsploit /usr/local/bin/searchsploit
sudo chmod +x /usr/local/bin/searchsploit
sed 's|path_array+=(.*)|path_array+=("/opt/exploit-database")|g' /opt/exploit-database/.searchsploit_rc \
 > ~/.searchsploit_rc


print "install revshell"
# esta mal tabulado y con expand se convierten las tabulaciones a espacios
curl https://raw.githubusercontent.com/dplastico/revshell/master/revshell.py | expand > /tmp/revshell
sudo mv /tmp/revshell /usr/local/bin/revshell
sudo chmod +x /usr/local/bin/revshell


print "install LinEnum"
sudo wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh \
 -O /usr/share/exploitation/le.sh
sudo chmod +x /usr/share/exploitation/le.sh


print "install knock"
sudo wget https://raw.githubusercontent.com/grongor/knock/master/knock \
 -O /usr/local/bin/knock
sudo chmod +x /usr/local/bin/knock


print "install privilege-escalation-awesome-scripts-suite"
DIR="/usr/share/exploitation/peass/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R


print "install metasploit"
curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-\
framework-wrappers/msfupdate.erb > msfinstall
chmod +x msfinstall
sudo ./msfinstall
/bin/rm msfinstall



# Requiere  glibc-devel.i686 glibc-devel
#DIR="/opt/the-backdoor-factory/"
#test -d $DIR && git -C $DIR pull
#! test -d $DIR && sudo git clone https://github.com/secretsquirrel/the-backdoor-factory $DIR \
# && sudo chown $(whoami):$(whoami) $DIR -R
#cd $DIR && sudo ./install.sh && cd -

#docker pull secretsquirrel/the-backdoor-factory
#docker run -it secretsquirrel/the-backdoor-factory bash
# ./backdoor.py


print "install pspy32"
sudo wget https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy32 \
 -O /usr/share/exploitation/pspy32
sudo chmod +x /usr/share/exploitation/pspy32


print "install pspy64"
sudo wget https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy64 \
 -O /usr/share/exploitation/pspy64
sudo chmod +x /usr/share/exploitation/pspy64




# Stress Testing












# Forensics Tools


sudo dnf install -y binwalk 










# Sniffing & Spoofing

 
sudo dnf install -y sipvicious wireshark libpcap-devel libusb-devel libnetfilter_queue-devel



print "install dnschef"
sudo wget https://raw.githubusercontent.com/iphelix/dnschef/master/dnschef.py \
 -O /usr/local/bin/dnschef
sudo chmod +x /usr/local/bin/dnschef
sudo pip3 install dnslib


print "install bettercap"
#https://github.com/bettercap/bettercap/releases/download/v2.28/bettercap_linux_amd64_v2.28.zip
DIR="/opt/bettercap/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/bettercap/bettercap $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
cd $DIR && make build -j4 && sudo make install -j4 && cd -
sudo bettercap -eval "caplets.update; ui.update; q"
# credential in /usr/local/share/bettercap/caplets/http-ui.cap (user/pass)
# start server web in http://127.0.0.1:80
# sudo bettercap -caplet http-ui &








# Password Attacks

sudo dnf install -y hashid hydra ncrack ophcrack fcrackzip

gem install bundler


print "install CeWL"
DIR="/opt/CeWL/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/digininja/CeWL $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
! test -f /usr/local/bin/cewl && sudo ln -s $DIR/cewl.rb /usr/local/bin/cewl
bundle update --bundler && bundle install
# Requisito CeWL
wget https://exiftool.org/Image-ExifTool-12.01.tar.gz -O /tmp/Image-ExifTool.tar.gz
sudo tar xvf /tmp/Image-ExifTool.tar.gz -C /opt/
sudo chown $(whoami):$(whoami) /opt/Image-ExifTool-12.01/ -R
cd /opt/Image-ExifTool-12.01/ && perl Makefile.PL && sudo make install -j && cd -


print "install crunch"
wget https://forensics.cert.org/cert-forensics-tools-release-32.rpm -O /tmp/cert-forensics.rpm
sudo rpm -Uvh /tmp/cert-forensics.rpm
sudo dnf --enablerepo=forensics install -y crunch
DIR="/opt/crunch/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/jim3ma/crunch $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
! test -f /usr/local/bin/cewl && sudo ln -s $DIR/cewl.rb /usr/local/bin/cewl
bundle update --bundler && bundle install


print "install gpp-decrypt"
sudo wget https://gitlab.com/kalilinux/packages/gpp-decrypt/-/raw/kali/master/gpp-decrypt.rb \
 -O /usr/local/bin/gpp-decrypt
sudo chmod +x /usr/local/bin/gpp-decrypt


print "install patator"
sudo dnf install -y libpq-devel ike-scan libsqlite3x-devel openldap python3-devel mysql-devel \
 sqlcipher sqlcipher-devel
DIR="/opt/patator/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/lanjelot/patator $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
cd $DIR && sudo pip install -r requirements.txt && sudo python setup.py install && cd -
! test -f /usr/local/bin/patator && sudo ln -s $DIR/patator.py /usr/local/bin/patator


print "install hashcat"
DIR="/opt/hashcat/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/hashcat/hashcat.git $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
cd $DIR && make -j4 && sudo make install -j4 && cd -
! test -f /usr/local/bin/patator && sudo ln -s $DIR/patator.py /usr/local/bin/patator


print "install john"
sudo dnf install -y openssl-devel
DIR="/opt/john/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/magnumripper/JohnTheRipper -b bleeding-jumbo $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
cd $DIR/src/ && ./configure && make -s clean && make -j4 && sudo make install -j4 && cd -
! test -f /usr/local/bin/john && sudo ln -s $DIR/run/john /usr/local/bin/john


print "install pysecdump"
DIR="/usr/share/exploitation/pysecdump/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/pentestmonkey/pysecdump $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R


print "install windows-privesc-check"
DIR="/usr/share/exploitation/windows-privesc-check/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/pentestmonkey/windows-privesc-check $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R













# Maintaining Access


sudo dnf install -y rlwrap socat nc
sudo dnf --enablerepo=forensics install -y cryptcat


print "install httptunnel"
DIR="/opt/httptunnel/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/larsbrinkhoff/httptunnel $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R
cd $DIR/ && ./autogen.sh && ./configure && make -j4 && sudo make install -j4 && cd -


print "install nishang"
DIR="/usr/share/exploitation/nishang/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/samratashok/nishang $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R


print "install PowerSploit"
DIR="/usr/share/exploitation/PowerSploit/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://github.com/PowerShellMafia/PowerSploit $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R


print "install webshells"
DIR="/usr/share/webshells/"
test -d $DIR && git -C $DIR pull
! test -d $DIR && sudo git clone https://gitlab.com/kalilinux/packages/webshells.git $DIR \
 && sudo chown $(whoami):$(whoami) $DIR -R


# fallo al compilar
#DIR="/opt/dns2tcp/"
#test -d $DIR && git -C $DIR pull
#! test -d $DIR && sudo git clone https://github.com/alex-sector/dns2tcp $DIR \
# && sudo chown $(whoami):$(whoami) $DIR -R
#cd $DIR/ && ./configure && make -j4 && sudo make install -j4 && cd -




# Reverse Engineering

sudo dnf --enablerepo=forensics install -y ghidra ltrace







# steganography


sudo dnf install -y steghide











# Reporting Tools


sudo updatedb 


